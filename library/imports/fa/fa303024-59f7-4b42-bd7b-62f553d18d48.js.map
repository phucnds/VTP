{"version":3,"sources":["assets/scripts/src/app/wsgw.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { connectWsgw, IWSGWClient } from \"@elofun/vds-gami-2022-wsgw\";\nimport LoadingCover from \"../../common/LoadingCover\";\nimport { ErrorHandleType, IAPIInterface } from \"./APIDefine\";\n\nexport const SERVICE_HOST = (/localhost/i.test(window.location.hostname) || /elofun.github.io/i.test(window.location.hostname))\n    ? `wss://vtpost.beta.elofun.net/wsgw/`\n    : (/.+cdn\\..+/.test(window.location.hostname)\n        ? window.location.href.replace(/^http/, 'ws').replace(/(.+)cdn\\.(.+)/, '$1.$2')\n        : (window.location.href.split('?')[0].replace('http', 'ws').replace('https', 'wss'))\n    ) + 'wsgw/';\n\n// const SERVICE_HOST = `wss://${window.location.host}/wsgw/`; // For production\n// const SERVICE_HOST = `wss://gami-mvt.elofun.net/wsgw/`; // For development\n\nexport const apiNeedLoading = [\n    'me',\n    'exchangeCoin',\n    'getAllRewardsHistory',\n    'getTicketsHistory',\n    'getCoinWinnerList',\n    'hitSaveNowButton',\n]\n\nconst TIMEOUT = {\n    bookAndClaimReward: 60000,\n    claimLoginReward: 60000,\n};\nconst DEBUG = true\nexport enum ErrorCode {\n    CONECTION_TIMEOUT = \"01\",\n    SERVER_EXCEPTION = \"02\",\n    CLIENT_EXCEPTION = \"03\",\n    NOT_AUTHENTICATED = \"04\",\n    OTHER_CASES = \"05\",\n    TIMEOUT_TXT = \"06\",\n}\ninterface IAPIResponse {\n    status: number;\n    data: any;\n}\ninterface IUserRequestAPIInfo {\n    api: IAPIInterface;\n    data: any;\n    onSuccess: any;\n    onFailed: any;\n}\nexport default new (class WSGW extends cc.SystemEvent {\n    private wsgw: Promise<IWSGWClient>;\n    public isAuthenticated: boolean = true;\n    private token: string = \"\";\n    private loading = 0;\n    constructor() {\n        super();\n    }\n    private userRequestedInfo: { [key: string]: IUserRequestAPIInfo } = {};\n    getWsgw() {\n        if (!this.wsgw) {\n            this.wsgw = connectWsgw(SERVICE_HOST);\n        }\n        return this.wsgw;\n    }\n    public clearWsgw() {\n        console.warn('Clear wsgw');\n        this.wsgw = null;\n    }\n    setAuthToken(token: string) {\n        if (this.token == token && this.isAuthenticated) return;\n        this.token = token;\n        return this.getWsgw().then(wsgw => wsgw.setAuthToken(token).then(() => this.isAuthenticated = true)).catch((e) => {\n            this.isAuthenticated = false;\n            this.setAuthToken(token);\n        });\n    }\n    request(service: string, api: string, data: any, timeout?: number): Promise<IAPIResponse> {\n        return this.getWsgw().then((wsgw) =>\n            wsgw.request(service, api, data, timeout)\n        );\n    }\n    // subscribe: (service: string, channel: string, cb?: (data: any) => void) => void;\n    onPromiseResolve(res, onSuccess, onFailed, service, api, type = null, retryTimes = 0) {\n        const { status, data } = res\n        if (status === 200) {\n            console.log(`${service}-${api} : sucess`)\n            DEBUG && console.log(data)\n            onSuccess && onSuccess(data);\n        } else {\n            console.log(`${service}-${api} : failed`)\n            console.log(res)\n            if (!this.isAuthenticated) {\n                setTimeout(() => {\n                    this.userRequest(type, data, onSuccess, onFailed, retryTimes - 1);\n                }, 1000)\n            } else {\n                if (status == 500) {\n                    if (res.data == \"TIMEOUT\") onFailed(ErrorCode.CONECTION_TIMEOUT)\n                    else onFailed(ErrorCode.SERVER_EXCEPTION)\n                }\n                else {\n                    onFailed(ErrorCode.OTHER_CASES, res)\n                }\n            }\n        }\n    }\n    loadingCountUp(api: string) {\n        if (apiNeedLoading.includes(api)) {\n            this.loading += 1;\n            LoadingCover.Instance.show();\n        }\n    }\n    loadingCountCountdown(api: string) {\n        if (apiNeedLoading.includes(api)) {\n            this.loading -= 1;\n            if (this.loading <= 0) {\n                LoadingCover.Instance.hide();\n            }\n        }\n    }\n    async userRequest(type: IAPIInterface, data: any, onSuccess, onFailed = console.error, retryTimes: number = 45) {\n        let apiType = `${type.service}-${type.api}`\n        this.userRequestedInfo[apiType] = { api: type, onSuccess, onFailed, data }\n        const { service, code, api } = type\n        DEBUG && console.log(`request : ${service}-${api}`)\n        const onFail = (reason: ErrorCode, res = null) => {\n            this.errorHandling(type, reason, data, onSuccess, onFailed, res);\n        }\n        if (retryTimes < 0) {\n            DEBUG && console.log(\"retry time out\")\n            onFail(ErrorCode.NOT_AUTHENTICATED)\n            return\n        }\n\n        this.loadingCountUp(type.api)\n\n        return this.request(service, api, data, TIMEOUT[api] || 15000)\n            .then((data) => {\n                this.loadingCountCountdown(type.api)\n\n                this.onPromiseResolve(data, onSuccess, onFail, service, api, type, retryTimes)\n            })\n            .catch((e) => {\n                console.error(\"errr\")\n                console.error(service, api)\n                console.error(e)\n                this.loadingCountCountdown(type.api)\n                if (typeof (e) == \"string\" && e.indexOf(\"timeout\") != -1) {\n                    onFail(ErrorCode.TIMEOUT_TXT);\n                    return;\n                }\n                onFail(ErrorCode.CLIENT_EXCEPTION)\n                // onFailed && onFailed(e);\n            });\n    }\n    retryApi(type: IAPIInterface, success, failed) {\n        let apiInfo = this.userRequestedInfo[`${type.service}-${type.api}`]\n        if (!apiInfo) return;\n        const { api, data, onFailed, onSuccess } = apiInfo\n        return this.userRequest(api, data, (e) => {\n            success && success(e)\n            onSuccess(e);\n        }, (e) => {\n            failed && failed(e)\n            onFailed(e);\n        })\n    }\n    errorHandling(type: IAPIInterface, reason: ErrorCode, data: any, onSuccess, onFailed = console.log, res = null) {\n        onFailed && onFailed(res);\n        const { service, code, api, errorHandleType } = type\n        if (errorHandleType == ErrorHandleType.NOTHING) return\n        this.emit(\"ELO_ERROR\", { type: errorHandleType, errorCode: `${('0' + code).slice(-2)}-${reason}`, api: type, res });\n    }\n    public on<T extends Function>(type: string, callback: T, target?: any, useCapture?: boolean): T {\n        return super.on(`${type}`, callback, target, useCapture);\n    }\n\n    public off(event: string | Symbol, listener: (...args: any[]) => void) {\n        super.off(`${String(event)}`, listener);\n        return this;\n    }\n\n    public once(event: string | symbol, listener: (...args: any[]) => void) {\n        super.once(`${String(event)}`, listener);\n        return this;\n    }\n\n    //---------noti bar-----\n    subscribeCompleteMission(cb = null) {\n        this.getWsgw().then((wsgw) => {\n            wsgw.subscribe('game', 'completeMission', (data) => {\n                cb && cb(data)\n            });\n        });\n    }\n    subscribeBuyTurn(cb = null) {\n        this.getWsgw().then((wsgw) => {\n            wsgw.subscribe('game', 'addTurn', (data) => {\n                cb && cb(data)\n            });\n        });\n    }\n    createErrorCallBack(code: number | string, type, cb) {\n        return { code, cb, type }\n    }\n})();\n"]}