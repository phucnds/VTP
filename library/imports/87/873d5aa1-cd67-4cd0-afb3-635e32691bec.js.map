{"version":3,"sources":["assets/scripts/Popups/PopupNewUserReward.ts"],"names":[],"mappings":";;;;;AAAA,oBAAoB;AACpB,wEAAwE;AACxE,mBAAmB;AACnB,kFAAkF;AAClF,8BAA8B;AAC9B,kFAAkF;;;;;;;;;;;;;;;;;;;;;AAElF,+CAA0C;AAG1C,0CAAqC;AAGrC,qDAA2E;AAC3E,iEAAqF;AAErF,0CAAqC;AACrC,iCAA4B;AAGtB,IAAA,KAAwB,EAAE,CAAC,UAAU,EAAnC,OAAO,aAAA,EAAE,QAAQ,cAAkB,CAAC;AAG5C;IAAgD,sCAAK;IAArD;QAAA,qEAqFC;QAnFU,mBAAa,GAAY,IAAI,CAAC;QAE9B,aAAO,GAAY,IAAI,CAAC;QAGxB,wBAAkB,GAAY,IAAI,CAAC;QAEnC,mCAA6B,GAAa,IAAI,CAAC;QAE/C,mBAAa,GAAY,IAAI,CAAC;QAE9B,8BAAwB,GAAa,IAAI,CAAC;QAEzC,UAAI,GAAW,CAAC,CAAC;QACjB,UAAI,GAAW,CAAC,CAAC;;QAyCzB,eAAe;QACf,kDAAkD;QAClD,uKAAuK;QACvK,uCAAuC;QACvC,6BAA6B;QAC7B,uMAAuM;QACvM,6DAA6D;QAC7D,oBAAoB;QAEpB,6CAA6C;QAC7C,6BAA6B;QAC7B,mJAAmJ;QACnJ,6DAA6D;QAC7D,oBAAoB;QACpB,IAAI;QAEJ,gCAAgC;QAChC,gEAAgE;QAChE,uCAAuC;QACvC,8CAA8C;QAC9C,iCAAiC;QACjC,oEAAoE;QAEpE,oDAAoD;QACpD,wFAAwF;QACxF,wFAAwF;QACxF,yBAAyB;QACzB,IAAI;IACR,CAAC;IAnEG,mCAAM,GAAN;QACI,iBAAM,MAAM,WAAE,CAAC;QAEf,IAAI,IAAI,CAAC,aAAa,EAAE;YACpB,gBAAM,CAAC,mBAAmB,CAAC,IAAI,CAAC,aAAa,EAAE;gBAC3C,kBAAQ,CAAC,OAAO,CAAC,kBAAQ,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;gBAC/C,eAAK,CAAC,QAAQ,CAAC,mBAAQ,EAAE,CAAC,CAAA;gBAC1B,MAAM,CAAC,QAAQ,CAAC,IAAI,GAAG,eAAK,CAAC,QAAQ,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,oCAAmB,CAAC,+BAAc,CAAC,kBAAkB,CAAC,CAAC,CAAC;YACnH,CAAC,CAAC,CAAC;SACN;QACD,IAAI,IAAI,CAAC,OAAO,EAAE;YACd,gBAAM,CAAC,mBAAmB,CAAC,IAAI,CAAC,OAAO,EAAE,cAAM,OAAA,eAAK,CAAC,QAAQ,CAAC,mBAAQ,EAAE,CAAC,EAA1B,CAA0B,CAAC,CAAC;SAC9E;IACL,CAAC;IAES,qCAAQ,GAAlB;QACI,iBAAM,QAAQ,WAAE,CAAC;QACjB,IAAM,YAAY,GAAG,eAAK,CAAC,QAAQ,EAAE,CAAC,IAAI,CAAC,YAAY,CAAC;QACxD,IAAI,YAAY,EAAE;YACd,IAAI,CAAC,kBAAkB,CAAC,MAAM,GAAG,KAAK,CAAC;YACvC,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,IAAI,CAAC;YACjC,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,KAAK,CAAC;SACrC;IAEL,CAAC;IAED,iCAAI,GAAJ,UAAK,IAAY,EAAE,IAAY;QAC3B,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC;QAC7C,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC;QAC7C,IAAI,CAAC,iBAAiB,EAAE,CAAC;IAC7B,CAAC;IAEM,8CAAiB,GAAxB;QACI,IAAM,OAAO,GAAG,IAAI,CAAC,IAAI,GAAG,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC;QAC3C,IAAM,IAAI,GAAG,CAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,EAAE,WAAI,OAAO,IAAI,IAAI,WAAI,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,EAAE,CAAE,CAAC;QAC9G,IAAI,CAAC,6BAA6B,CAAC,MAAM,GAAG,IAAI,CAAC;QACjD,IAAI,CAAC,wBAAwB,CAAC,MAAM,GAAG,IAAI,CAAC;IAChD,CAAC;IArDD;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;6DACmB;IAErC;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;uDACa;IAG/B;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;kEACwB;IAE1C;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;6EACmC;IAEtD;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;6DACmB;IAErC;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;wEAC8B;IAbhC,kBAAkB;QADtC,OAAO;OACa,kBAAkB,CAqFtC;IAAD,yBAAC;CArFD,AAqFC,CArF+C,eAAK,GAqFpD;kBArFoB,kBAAkB","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\nimport SoundMgr from \"../common/SoundMgr\";\nimport { userProfile } from \"../common/UserProfile\";\nimport APIDefine from \"../src/app/APIDefine\";\nimport store from \"../src/app/store\";\nimport wsgw from \"../src/app/wsgw\";\nimport { trackUserInteract } from \"../src/common/utils\";\nimport { EAppPopups, popPopup, pushPopup } from \"../src/features/SliceApp\";\nimport { DeeplinkTypesToName, EDeeplinkTypes } from \"../src/features/SliceDeeplinks\";\nimport { syncLoginStreak } from \"../src/features/SliceLogin\";\nimport Helper from \"../utils/Helper\";\nimport Popup from \"./Popup\";\nimport PopupDailyLogin from \"./PopupDailyLogin\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class PopupNewUserReward extends Popup {\n    @property(cc.Node)\n    public btnUpdateInfo: cc.Node = null;\n    @property(cc.Node)\n    public btnSpin: cc.Node = null;\n\n    @property(cc.Node)\n    public ShellUserContainer: cc.Node = null;\n    @property(cc.Label)\n    public ShellUserContainerDescription: cc.Label = null;\n    @property(cc.Node)\n    public UserContainer: cc.Node = null;\n    @property(cc.Label)\n    public UserContainerDescription: cc.Label = null;\n\n    private coin: Number = 0;\n    private turn: Number = 0;\n\n    onLoad() {\n        super.onLoad();\n\n        if (this.btnUpdateInfo) {\n            Helper.registerButtonEvent(this.btnUpdateInfo, () => {\n                SoundMgr.playSfx(SoundMgr.Instance.SFX_BUTTON);\n                store.dispatch(popPopup())\n                window.location.href = store.getState().deeplinks.data[DeeplinkTypesToName[EDeeplinkTypes.XAC_THUC_THONG_TIN]];\n            });\n        }\n        if (this.btnSpin) {\n            Helper.registerButtonEvent(this.btnSpin, () => store.dispatch(popPopup()));\n        }\n    }\n\n    protected onEnable(): void {\n        super.onEnable();\n        const verifiedUser = store.getState().user.verifiedUser;\n        if (verifiedUser) {\n            this.ShellUserContainer.active = false;\n            this.UserContainer.active = true;\n            this.btnUpdateInfo.active = false;\n        }\n\n    }\n\n    init(coin: Number, turn: Number) {\n        this.coin = Number(this.coin) + Number(coin);\n        this.turn = Number(this.turn) + Number(turn);\n        this.updateDescription();\n    }\n\n    public updateDescription() {\n        const hasBoth = this.coin > 0 && this.turn;\n        const text = `${this.coin ? this.coin + ' Xu' : ''} ${hasBoth && 'và'} ${this.turn ? this.turn + ' vé' : ''}`;\n        this.ShellUserContainerDescription.string = text;\n        this.UserContainerDescription.string = text;\n    }\n\n    // nextAnim() {\n    //     this.GreetingRewardContainer.active = true;\n    //     this.GreetingRewardContainer.setPosition(cc.v3(cc.find('Canvas').width + 300, this.GreetingRewardContainer.position.y, this.GreetingRewardContainer.position.z))\n    //     cc.tween(this.GreetingContainer)\n    //         .set({ scale: 1 })\n    //         .to(0.5, { position: cc.v3(this.GreetingContainer.position.x - cc.find('Canvas').width - 300, this.GreetingContainer.position.y, this.GreetingContainer.position.z) }, { easing: \"smooth\" })\n    //         .call(() => this.GreetingContainer.active = false)\n    //         .start();\n\n    //     cc.tween(this.GreetingRewardContainer)\n    //         .set({ scale: 1 })\n    //         .to(0.5, { position: cc.v3(0, this.GreetingRewardContainer.position.y, this.GreetingRewardContainer.position.z) }, { easing: \"smooth\" })\n    //         .call(() => this.GreetingContainer.active = false)\n    //         .start();\n    // }\n\n    // protected onDisable(): void {\n    //     wsgw.userRequest(APIDefine.claimLoginReward, {}, (e) => {\n    //         userProfile.UpdateBalance();\n    //         store.dispatch(syncLoginStreak(e));\n    //         if (e.message) return;\n    //         // store.dispatch(pushPopup(EAppPopups.PopupDailyLogin));\n\n    //         // const { coin, turn, loginStreak } = e;\n    //         // const popup = cc.find('Canvas/PopupManager/Shown Popups/PopupDailyLogin');\n    //         // popup && popup.getComponent(PopupDailyLogin).init(coin, turn, loginStreak)\n    //     }, console.error);\n    // }\n}\n"]}