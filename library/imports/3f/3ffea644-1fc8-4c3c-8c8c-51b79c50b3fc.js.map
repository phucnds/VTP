{"version":3,"sources":["assets/scripts/Pages/PageMgr.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import * as R from 'ramda';\nimport connect from \"../src/app/connect\";\nimport store, { AppDispatch, RootState } from \"../src/app/store\";\nimport { EAppPages, EAppPopups, PAGE_SHOW_EFFECT, pushPopup } from \"../src/features/SliceApp\";\nimport Page from \"./Page\";\nimport Localization from \"../common/Localization\";\nimport SoundMgr from \"../common/SoundMgr\";\nimport wsgw from \"../src/app/wsgw\";\nimport { checkRewardPopup } from \"../src/common/common\";\nimport APIDefine from \"../src/app/APIDefine\";\nimport { syncQuests } from \"../src/features/SliceQuests\";\nimport { userProfile } from \"../common/UserProfile\";\nconst { ccclass, property } = cc._decorator;\n\nexport const pageNameMap = {\n    home: 'PageHome',\n    rules: 'PageRules',\n    buyTurn: 'PageBuyTurn',\n    inventory: 'PageInventory',\n    reward: 'PageReward',\n    savenow: 'PageSavenow',\n    weeklyPrizeHistory: 'PageWeeklyPrizeHistory',\n    paynow: 'PagePaynow',\n    guiTietKiem: 'PageGuiTietKiem',\n}\n\nexport class PageMgr extends cc.Component {\n    actions: any;\n    props: RootState;\n\n    @property(cc.Prefab) private PagePrefabs: Array<cc.Prefab> = [];\n\n    private pageCover: cc.Node = null;\n    private Canvas: cc.Node = null;\n    private mPreviousView: cc.Node = null;\n    private mCurrentView: cc.Node = null;\n    private mCurrentPageView: EAppPages = null;\n    private needToCheckRewardPopup = false;\n    static Instance: PageMgr\n    static show(viewName: EAppPages,\n        effectType: PAGE_SHOW_EFFECT = PAGE_SHOW_EFFECT.APPEAR,\n        easing: string = \"smooth\",\n        duration: number = 0.3) {\n        const instance = this.Instance;\n        instance.mPreviousView = instance.mCurrentView;\n        // cc.find('Canvas').getChildByName(\"NodeFixedOnUI\").active = true;\n        for (let view of instance.node.children) {\n            const isActive = view.name == EAppPages[viewName];\n            if (isActive) {\n                instance.mCurrentView = view;\n            }\n\n            if (view.active != isActive) {\n                view.active = isActive;\n            }\n        }\n\n        if (instance.mPreviousView && instance.mCurrentView && instance.mPreviousView != instance.mCurrentView) {\n            instance.animate(effectType, easing, duration, viewName);\n        }\n        else {\n            instance.mCurrentView.getComponent(EAppPages[viewName])?.init();\n        }\n    }\n    static hide() {\n        const instance = this.Instance;\n        for (let view of instance.node.children) {\n            view.active = false;\n        }\n    }\n    static getUI<T>(viewName: EAppPages): T {\n        return this.Instance.node.getChildByName(EAppPages[viewName]).getComponent(EAppPages[viewName]);\n    }\n\n    onLoad() {\n        // super.onLoad();\n        // if (!(/localhost/i.test(window.location.hostname) || /elofun.github.io/i.test(window.location.hostname))) {\n        //     console.log = console.clear\n        //     console.warn = console.clear\n        //     console.error = console.clear\n        // }\n        // setInterval(() => {\n        //     cc.screen.requestFullScreen();\n        // }, 1000);\n\n        (window as any).vdsShareMissionCallback = (payload) => {\n            setTimeout(() => {\n                userProfile.UpdateProfile(true, () => {\n                    wsgw.userRequest(APIDefine.getMissionList, {}, (e) => {\n                        store.dispatch(syncQuests(e));\n                    }, console.error);\n                    checkRewardPopup()\n                    userProfile.UpdateBalance();\n                });\n            }, 1000);\n        }\n\n        (window as any).vdsCompleteMissionCallback = (payload) => {\n            setTimeout(() => {\n                userProfile.UpdateProfile(true, () => {\n                    wsgw.userRequest(APIDefine.getMissionList, {}, (e) => {\n                        store.dispatch(syncQuests(e));\n                    }, console.error);\n                    checkRewardPopup()\n                    userProfile.UpdateBalance();\n                });\n            }, 1000);\n        }\n\n        (window as any).vdsBuyTurnCallback = (payload) => {\n        }\n\n        // window.addEventListener(\"message\", (event) => {\n        //     const prefix = typeof event.data === 'string' ? event.data.split('_').shift() : '';\n\n        //     if (prefix === 'redirect') {\n        //         const postFix = typeof event.data === 'string' ? event.data.split('_').pop() : '';\n        //         this.actions.pushPage({ page: postFix, effect: PAGE_SHOW_EFFECT.LEFT })\n        //     }\n\n        //     if (prefix === 'complete-quest') {\n        //         setTimeout(() => {\n        //             userProfile.UpdateProfile(true, () => {\n        //                 wsgw.userRequest(APIDefine.getMissionList, {}, (e) => {\n        //                     store.dispatch(syncQuests(e));\n        //                 }, console.error);\n        //                 checkRewardPopup()\n        //                 userProfile.UpdateBalance();\n        //             });\n        //         }, 1000);\n        //     }\n        // });\n\n        cc.game.on(cc.game.EVENT_HIDE, () => {\n            this.needToCheckRewardPopup = true;\n            SoundMgr.setMute(true);\n        });\n\n        cc.game.on(cc.game.EVENT_SHOW, () => {\n            if (!this.needToCheckRewardPopup) return;\n            this.needToCheckRewardPopup = false;\n            const muteSetting = localStorage.getItem('mute') === 'true';\n            SoundMgr.setMute(muteSetting);\n            setTimeout(() => {\n                userProfile.UpdateProfile(true, () => {\n                    wsgw.userRequest(APIDefine.getMissionList, {}, (e) => {\n                        store.dispatch(syncQuests(e));\n                    }, console.error);\n                    checkRewardPopup()\n                    userProfile.UpdateBalance();\n                });\n            }, 1000);\n        });\n\n        cc.view.enableAutoFullScreen(false)\n        cc.view.resizeWithBrowserSize(false)\n        PageMgr.Instance = this;\n        for (let i = 0; i < this.PagePrefabs.length; i++) {\n            if (!this.PagePrefabs[i]) continue\n            const node = cc.instantiate(this.PagePrefabs[i]);\n            node.active = false;\n            this.node.addChild(node);\n            // node.group = \"UI\"\n        }\n        this.Canvas = cc.find(\"Canvas\");\n    }\n\n    start() {\n        (window as any).appVersion = \"0.9.10 - 26/08/2022\"\n        console.log(\"Version : \" + (window as any).appVersion);\n        this.pageCover = cc.find('Canvas').getChildByName(\"Stage Cover\");\n        this.pageCover.active = false;\n        cc.find('Canvas').getChildByName(\"TopUI\").active = false\n        this.onStateChange()\n        SoundMgr.playMusic(SoundMgr.Instance.BGM, true)\n        let lang = localStorage.getItem(\"lang\") || \"vi\"\n        let bgmActive = Number(localStorage.getItem(\"bgm\") || \"1\")\n        let sfxActive = Number(localStorage.getItem(\"sfx\") || \"1\")\n        SoundMgr.setSfxVolume(sfxActive)\n        SoundMgr.setMusicVolume(bgmActive)\n        Localization.ChangeLanguage(lang)\n        cc.view.enableAutoFullScreen(false)\n    }\n    onStateChange() {\n        if (this.mCurrentPageView != this.props.app.currentPage) {\n            this.mCurrentPageView = this.props.app.currentPage\n            PageMgr.show(this.props.app.currentPage, this.props.app.effectType);\n            // let pageHasTopUI = [EAppPages.PageHome, EAppPages.PageWinner, EAppPages.PagePrizes]\n            // cc.find('Canvas').getChildByName(\"TopUI\").active = pageHasTopUI.includes(this.props.app.currentPage) && (!shallowEqualObjects(this.props.games, {}));\n        }\n    }\n    private animate(effectType: PAGE_SHOW_EFFECT, easing: string, duration: number, viewName: EAppPages) {\n        this.mPreviousView.active = true;\n        this.mCurrentView.active = true;\n\n        let previousViewPosition = null;\n        let currentViewPosition = null;\n        switch (effectType) {\n            case PAGE_SHOW_EFFECT.APPEAR:\n                {\n                    this.mPreviousView.active = false;\n                    this.mCurrentView.getComponent(EAppPages[viewName])?.init()\n                    break;\n                }\n\n            case PAGE_SHOW_EFFECT.UP:\n                {\n                    currentViewPosition = cc.v2(0, - this.Canvas.height * 1);\n                    previousViewPosition = cc.v2(0, this.Canvas.height * 1);\n                    break;\n                }\n            case PAGE_SHOW_EFFECT.DOWN:\n                {\n                    currentViewPosition = cc.v2(0, this.Canvas.height * 1);\n                    previousViewPosition = cc.v2(0, - this.Canvas.height * 1);\n                    break;\n                }\n            case PAGE_SHOW_EFFECT.LEFT:\n                {\n                    currentViewPosition = cc.v2(this.Canvas.width * 1, this.Canvas.height / 2);\n                    previousViewPosition = cc.v2(- this.Canvas.width * 1, this.Canvas.height / 2);\n                    break;\n                }\n            case PAGE_SHOW_EFFECT.RIGHT:\n                {\n                    currentViewPosition = cc.v2(- this.Canvas.width * 1, this.Canvas.height / 2);\n                    previousViewPosition = cc.v2(this.Canvas.width * 1, this.Canvas.height / 2);\n                    break;\n                }\n            case PAGE_SHOW_EFFECT.SCALE:\n                {\n                    this.mCurrentView.setScale(cc.Vec2.ZERO);\n                    cc.tween(this.mPreviousView)\n                        .to(duration, { scale: 0 }, { easing })\n                        .call(() => this.mPreviousView.active = false)\n                        .start();\n                    cc.tween(this.mCurrentView)\n                        .delay(duration)\n                        .to(duration, { scale: 1 }, { easing })\n                        .call(() => this.mCurrentView.getComponent(EAppPages[viewName])?.init())\n                        .start();\n\n                    break;\n                }\n            case PAGE_SHOW_EFFECT.FADE:\n                {\n                    this.pageCover.active = true;\n                    this.mCurrentView.active = false;\n\n                    cc.tween(this.mPreviousView)\n                        .to(duration, { scale: this.mPreviousView.scaleX }, {\n                            progress: (start, end, current, ratio) => {\n                                // this.mPreviousStage.opacity = (1 - ratio) * 255;\n                                this.pageCover.opacity = ratio * 255;\n                                return start + (end - start) * ratio;\n                            }\n                        })\n                        .call(() => {\n                            this.mPreviousView.active = false;\n                            this.mCurrentView.active = true;\n                            // this.mCurrentView.getComponent(EAppPages[viewName]).init();\n                        })\n                        .start();\n                    cc.tween(this.mCurrentView)\n                        .delay(duration)\n                        .to(duration, { scale: this.mCurrentView.scaleX }, {\n                            progress: (start, end, current, ratio) => {\n                                // this.mCurrentStage.opacity = ratio * 255;\n                                this.pageCover.opacity = (1 - ratio) * 255;\n                                return start + (end - start) * ratio;\n                            }\n                        })\n                        .call(() => {\n                            this.pageCover.active = false;\n                        })\n                        .start();\n                    break;\n                }\n        }\n        if (previousViewPosition && currentViewPosition) {\n            cc.tween(this.mPreviousView)\n                .set({ scale: 1 })\n                .to(duration, { position: previousViewPosition }, { easing })\n                .call(() => this.mPreviousView.active = false)\n                .start();\n            cc.tween(this.mCurrentView)\n                .set({ opacity: 0, scale: 1 })\n                .delay(0)\n                .set({ position: currentViewPosition, opacity: 255 })\n                .to(duration, { position: cc.v3(0, this.Canvas.height / 2, 0) }, { easing })\n                .call(() => this.mCurrentView.getComponent(EAppPages[viewName])?.init())\n                .start();\n        }\n    }\n}\nconst mapStateToProps = (state: RootState) => ({\n    app: state.app,\n})\nconst mapDispatchToAction = (dispatch: AppDispatch) => ({\n    pushPopup: (e: EAppPopups) => dispatch(pushPopup(e)),\n})\nexport default connect(mapStateToProps, mapDispatchToAction)(PageMgr)"]}