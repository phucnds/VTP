{"version":3,"sources":["assets/scripts/Popups/PopupBuyWeeklyTicket.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\nimport * as R from 'ramda';\nimport moment = require(\"moment\");\nimport connect from \"../src/app/connect\";\nimport store, { AppDispatch, RootState } from \"../src/app/store\";\nimport { getRemainTime, getRemanningTime } from \"../src/common/utils\";\nimport { EAppPages, EAppPopups, IPageWithEffect, PAGE_SHOW_EFFECT, popPage, popPopup, pushPage, pushPopup } from \"../src/features/SliceApp\";\nimport FrameMgr from '../common/FrameMgr';\nimport GameDefine from '../src/common/GameDefine';\nimport SoundMgr from '../common/SoundMgr';\nimport APIDefine from '../src/app/APIDefine';\nimport wsgw from '../src/app/wsgw';\nimport Popup from './Popup';\nimport { syncWeeklyTicket } from '../src/features/SliceWeeklyTicket';\nimport { userProfile } from '../common/UserProfile';\n\n\nconst { ccclass, property } = cc._decorator;\n\nexport class PopupBuyWeeklyTicket extends Popup {\n    actions: any;\n    props: RootState\n\n    @property(cc.Node)\n    public btnContainer: cc.Node = null;\n    @property(cc.Node)\n    public btnResult: cc.Node = null;\n    @property(cc.Node)\n    public btnBuy: cc.Node = null;\n    @property(cc.Node)\n    public btnClose: cc.Node = null;\n    @property(cc.Sprite)\n    public title: cc.Sprite = null;\n\n    @property(cc.Node)\n    public buyTicketContainer: cc.Node = null;\n    @property(cc.Label)\n    public dayTxt1: cc.Label = null;\n    @property(cc.Label)\n    public dayTxt2: cc.Label = null;\n    @property(cc.Label)\n    public hourTxt1: cc.Label = null;\n    @property(cc.Label)\n    public hourTxt2: cc.Label = null;\n    @property(cc.Label)\n    public minuteTxt1: cc.Label = null;\n    @property(cc.Label)\n    public minuteTxt2: cc.Label = null;\n    @property(cc.Label)\n    public secondTxt1: cc.Label = null;\n    @property(cc.Label)\n    public secondTxt2: cc.Label = null;\n\n    @property(cc.Node)\n    public boughtTicketContainer: cc.Node = null;\n    @property(cc.Label)\n    public duedate: cc.Label = null;\n    @property(cc.Label)\n    public boughtTicketContainerCountdown: cc.Label = null;\n\n    @property(cc.Node)\n    public rollPhaseCompletedTicketContainer: cc.Node = null;\n    @property(cc.Node)\n    public rollPhaseCompletedNoTicketContainer: cc.Node = null;\n    @property(cc.Node)\n    public eventEndedContainer: cc.Node = null;\n\n    @property(cc.Node)\n    public notBuyTimeoutTicketContainer: cc.Node = null;\n    @property(cc.Label)\n    public notBuyTimeoutTicketContainerDate: cc.Label = null;\n\n    private time = 0;\n\n    onLoad() {\n        super.onLoad();\n        this.btnBuy.on(cc.Node.EventType.TOUCH_END, () => {\n            if (!this.btnBuy.getComponent(cc.Button).interactable) return;\n            SoundMgr.playSfx(SoundMgr.Instance.SFX_BUTTON);\n            wsgw.userRequest(APIDefine.exchangeCoin, {}, (e) => {\n                this.activeBuyButton(false)\n                this.actions.popPopup();\n                this.actions.pushPopup(EAppPopups.PopupBuyWeeklyTicketSuccess);\n                wsgw.userRequest(APIDefine.checkWeeklyTicket, {}, (e) => {\n                    store.dispatch(syncWeeklyTicket({ bought: true }))\n                }, console.error);\n                userProfile.UpdateBalance();\n            }, console.error);\n        });\n\n        this.btnResult.on(cc.Node.EventType.TOUCH_END, () => {\n            SoundMgr.playSfx(SoundMgr.Instance.SFX_BUTTON);\n            this.actions.popPopup();\n            this.actions.pushPage({ page: EAppPages.PageWeeklyPrizeHistory, effect: PAGE_SHOW_EFFECT.LEFT });\n        });\n\n        this.btnClose.on(cc.Node.EventType.TOUCH_END, () => {\n            SoundMgr.playSfx(SoundMgr.Instance.SFX_BUTTON);\n            this.actions.popPopup();\n        });\n    }\n\n    protected update(dt: number): void {\n        this.syncTime();\n    }\n\n    activeBuyButton(enable: boolean) {\n        this.btnBuy.getComponent(cc.Button).interactable = enable;\n        this.btnBuy.getChildByName('Background').color = enable ? new cc.Color(255, 255, 255) : new cc.Color(221, 221, 221);\n        this.btnBuy.getChildByName('Label').color = enable ? new cc.Color(255, 0, 0) : new cc.Color(134, 134, 134);\n    }\n\n    protected onEnable(): void {\n        super.onEnable();\n        const coin = R.view(R.lensPath(['user', 'coinBalance']))(this.props);\n        if (coin < GameDefine.WEEKLY_EXCHANGE_AMOUNT) {\n            this.activeBuyButton(false)\n        } else {\n            this.activeBuyButton(true)\n        }\n    }\n\n    disableAllContainer() {\n        this.buyTicketContainer.active = false;\n        this.boughtTicketContainer.active = false;\n        this.rollPhaseCompletedTicketContainer.active = false;\n        this.notBuyTimeoutTicketContainer.active = false;\n        this.eventEndedContainer.active = false;\n        this.rollPhaseCompletedNoTicketContainer.active = false;\n    }\n    disableAllButtons() {\n        this.btnResult.active = false;\n        this.btnBuy.active = false;\n        this.btnClose.active = false;\n        this.btnContainer.active = true;\n    }\n\n\n    syncTime() {\n        if (Math.floor(new Date().valueOf() / 1000) === this.time) {\n            return;\n        }\n\n        this.time = Math.floor(new Date().valueOf() / 1000)\n\n        this.disableAllContainer();\n        this.disableAllButtons();\n        this.title.spriteFrame = FrameMgr.Instance.POPUP_TITLE_WEEKLY_TICKET;\n        const { second: eventRemainingSeconds } = getRemanningTime(new Date(GameDefine.EVENT_END_DATE));\n        if (eventRemainingSeconds < 0) {\n            this.title.spriteFrame = FrameMgr.Instance.POPUP_TITLE_NOTI;\n            this.eventEndedContainer.active = true;\n            this.btnClose.active = true;\n            return;\n        }\n\n        const buyPhaseDueDate = moment().endOf('isoWeek').startOf('day').add(19, \"hours\").add(50, 'minutes');\n        const rollPhaseDueDate = moment().endOf('isoWeek').startOf('day').add(20, \"hours\");\n        const {\n            day: dayBuy, hour: hourBuy, minute: minuteBuy, second: secondBuy\n        } = getRemanningTime(new Date(buyPhaseDueDate.valueOf()));\n        const {\n            day: dayRoll, hour: hourRoll, minute: minuteRoll, second: secondRoll\n        } = getRemanningTime(new Date(rollPhaseDueDate.valueOf()));\n\n        const isTicketBought = R.view(R.lensPath(['weeklyTicket', 'bought']), this.props);\n\n        if (isTicketBought) { // Da mua ve\n            if (secondRoll < 0) { // Da roll xong\n                this.rollPhaseCompletedTicketContainer.active = true;\n                this.btnResult.active = true;\n                this.title.spriteFrame = FrameMgr.Instance.POPUP_TITLE_NOTI;\n                return;\n            }\n\n            this.boughtTicketContainer.active = true;\n            this.btnResult.active = true;\n\n            this.duedate.string = '20h00 Chủ nhật ' + buyPhaseDueDate.format('DD/MM/YYYY');\n            this.boughtTicketContainerCountdown.string = `${dayRoll.toString().padStart(2, '0')} ngày ${hourRoll.toString().padStart(2, '0')} giờ ${minuteRoll.toString().padStart(2, '0')} phút ${secondRoll.toString().padStart(2, '0')} giây`;\n\n            return;\n        } else {// Chua mua ve\n            if (secondRoll < 0) { // Da roll xong\n                this.rollPhaseCompletedNoTicketContainer.active = true;\n                this.btnResult.active = true;\n                this.title.spriteFrame = FrameMgr.Instance.POPUP_TITLE_NOTI;\n                return;\n            }\n\n            if (secondBuy < 0) { // Het buy phase\n                this.notBuyTimeoutTicketContainer.active = true;\n                this.btnClose.active = true;\n\n                this.notBuyTimeoutTicketContainerDate.string = rollPhaseDueDate.format('DD/MM/YYYY');\n                this.title.spriteFrame = FrameMgr.Instance.POPUP_TITLE_NOTI;\n            } else {// Con buy phase\n                this.buyTicketContainer.active = true;\n                this.btnResult.active = true;\n                this.btnBuy.active = true;\n\n                this.dayTxt1.string = Math.floor(dayBuy / 10).toString();\n                this.dayTxt2.string = (dayBuy % 10).toString();\n\n                this.hourTxt1.string = Math.floor(hourBuy / 10).toString();\n                this.hourTxt2.string = (hourBuy % 10).toString();\n\n                this.minuteTxt1.string = Math.floor(minuteBuy / 10).toString();\n                this.minuteTxt2.string = (minuteBuy % 10).toString();\n\n                this.secondTxt1.string = Math.floor(secondBuy / 10).toString();\n                this.secondTxt2.string = (secondBuy % 10).toString();\n            }\n\n            return;\n        }\n    }\n}\n\nconst mapStateToProps = (state: RootState) => ({\n    weeklyTicket: state.weeklyTicket,\n    user: state.user\n})\nconst mapDispatchToAction = (dispatch: AppDispatch) => ({\n    pushPage: (payload: EAppPages | IPageWithEffect) =>\n        dispatch(pushPage(payload)),\n    popPage: () => dispatch(popPage()),\n    pushPopup: (payload: EAppPopups) => dispatch(pushPopup(payload)),\n    popPopup: () => dispatch(popPopup()),\n})\nexport default connect(mapStateToProps, mapDispatchToAction)(PopupBuyWeeklyTicket)\n"]}