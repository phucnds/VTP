{"version":3,"sources":["assets/scripts/src/app/connect.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAA,+CAAoD;AACpD,iCAA4B;AAE5B,SAAS,OAAO,CACd,eAAoC,EACpC,kBAAoC;IAEpC,OAAO,UAAU,MAAM;QACrB,IAAI,GAAG,GAAG,EAAE,CAAC,KAAK,uBACb,CAAC,CAAC,MAAM;YACT,MAAM,CAAC,gBAAgB;YACvB,MAAM,CAAC,gBAAgB,CAAC,KAAK,CAAC;YAC9B,EAAE,CAAC,KACL,OAAO,EAAE,MAAM,EACf,MAAM;gBAAN,iBAiBC;gBAhBC,IAAI,CAAC,OAAO,GAAG,kBAAkB,IAAI,kBAAkB,CAAC,eAAK,CAAC,QAAQ,CAAC,CAAC;gBACxE,IAAI,CAAC,KAAK,GAAG,eAAe,CAAC,eAAK,CAAC,QAAQ,EAAE,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;gBAC3D,IAAI,CAAC,UAAU,GAAG,eAAK,CAAC,SAAS,CAAC;oBAChC,IAAM,KAAK,GAAG,eAAK,CAAC,QAAQ,EAAE,CAAC;oBAC/B,IAAM,KAAK,GAAG,eAAe,CAAC,KAAK,EAAE,KAAI,CAAC,KAAK,CAAC,CAAC;oBACjD,IAAI,CAAC,mCAAmB,CAAC,KAAK,EAAE,KAAI,CAAC,KAAK,CAAC,EAAE;wBAC3C,KAAI,CAAC,KAAK,GAAG,KAAK,CAAC;wBACnB,IAAI,KAAI,CAAC,IAAI,IAAI,KAAI,CAAC,OAAO,EAAE;4BAC7B,KAAI,CAAC,aAAa,IAAI,KAAI,CAAC,aAAa,EAAE,CAAC;yBAC5C;6BACI;4BACH,KAAI,CAAC,WAAW,GAAG,IAAI,CAAC;yBACzB;qBACF;gBACH,CAAC,CAAC,CAAC;gBACH,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,EAAE,CAAC;YAC/B,CAAC;YACD,aAAa;gBACX,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,EAAE,CAAC;YAC/B,CAAC;YACD,QAAQ;gBACN,IAAI,CAAC,OAAO,GAAG,IAAI,CAAA;gBACnB,IAAI,IAAI,CAAC,WAAW,EAAE;oBACpB,IAAI,CAAC,aAAa,IAAI,IAAI,CAAC,aAAa,EAAE,CAAC;iBAC5C;gBACD,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,EAAE,CAAC;YAC/B,CAAC;YACD,SAAS;gBACP,IAAI,CAAC,OAAO,GAAG,KAAK,CAAA;gBACpB,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,EAAE,CAAC;YAC/B,CAAC;YACD,SAAS;gBACP,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,EAAE,CAAC;gBACrC,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,EAAE,CAAC;YAC/B,CAAC,IACD,CAAC;QACH,OAAO,GAAG,CAAC;IACb,CAAC,CAAC;AACJ,CAAC;AAED,kBAAe,OAAO,CAAC","file":"","sourceRoot":"/","sourcesContent":["import { shallowEqualObjects } from \"shallow-equal\";\nimport store from \"./store\";\n\nfunction connect<T = any, A = any>(\n  mapStateToProps: (state, props) => T,\n  mapDispatchToProps?: (dispatch) => A\n) {\n  return function (target) {\n    var res = cc.Class({\n      ...((target &&\n        target.__ccclassCache__ &&\n        target.__ccclassCache__.proto) ||\n        {}),\n      extends: target,\n      onLoad() {\n        this.actions = mapDispatchToProps && mapDispatchToProps(store.dispatch);\n        this.props = mapStateToProps(store.getState(), this.props);\n        this.unsubcribe = store.subscribe(() => {\n          const state = store.getState();\n          const props = mapStateToProps(state, this.props);\n          if (!shallowEqualObjects(props, this.props)) {\n            this.props = props;\n            if (this.node && this._active) {\n              this.onStateChange && this.onStateChange();\n            }\n            else {\n              this._needUpdate = true;\n            }\n          }\n        });\n        this._super && this._super();\n      },\n      onStateChange() {\n        this._super && this._super();\n      },\n      onEnable() {\n        this._active = true\n        if (this._needUpdate) {\n          this.onStateChange && this.onStateChange();\n        }\n        this._super && this._super();\n      },\n      onDisable() {\n        this._active = false\n        this._super && this._super();\n      },\n      onDestroy() {\n        this.unsubcribe && this.unsubcribe();\n        this._super && this._super();\n      }\n    });\n    return res;\n  };\n}\n\nexport default connect;\n"]}