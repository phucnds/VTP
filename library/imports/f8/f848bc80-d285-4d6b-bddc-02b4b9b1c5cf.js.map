{"version":3,"sources":["assets/scripts/Popups/PopupError.ts"],"names":[],"mappings":";;;;;AAAA,oBAAoB;AACpB,wEAAwE;AACxE,mBAAmB;AACnB,kFAAkF;AAClF,8BAA8B;AAC9B,kFAAkF;;;;;;;;;;;;;;;;;;;;;;;AAGlF,+CAA0C;AAE1C,8CAAyC;AAEzC,wCAAkD;AAClD,qDAAsG;AACtG,iEAAqF;AACrF,yDAA0D;AAE1D,iCAA4B;AAEtB,IAAA,KAAwB,EAAE,CAAC,UAAU,EAAnC,OAAO,aAAA,EAAE,QAAQ,cAAkB,CAAC;AAE/B,QAAA,kBAAkB;IAC3B,GAAC,gBAAS,CAAC,gBAAgB,IAAG,mDAAmD;IACjF,GAAC,gBAAS,CAAC,iBAAiB,IAAG,4CAA4C;IAC3E,GAAC,gBAAS,CAAC,iBAAiB,IAAG,mDAAmD;IAClF,GAAC,gBAAS,CAAC,WAAW,IAAG,mDAAmD;IAC5E,GAAC,gBAAS,CAAC,gBAAgB,IAAG,mDAAmD;IACjF,GAAC,gBAAS,CAAC,WAAW,IAAG,4CAA4C;QACxE;AACD;IAAgC,8BAAK;IAArC;QAAA,qEAkFC;QA/E4B,oBAAc,GAAG,QAAQ,CAAC;QAChC,cAAQ,GAAY,IAAI,CAAC;QACzB,aAAO,GAAY,IAAI,CAAC;QACxB,cAAQ,GAAY,IAAI,CAAC;QACxB,eAAS,GAAa,IAAI,CAAC;QAC3B,aAAO,GAAa,IAAI,CAAC;QACzB,eAAS,GAAa,IAAI,CAAC;QAC3B,cAAQ,GAAa,IAAI,CAAC;;IAwElD,CAAC;IApEG,wBAAwB;IACxB,6BAAQ,GAAR;QACI,IAAI,CAAC,aAAa,EAAE,CAAC;QACrB,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAA;QACtE,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAA;QACpE,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAA;IAC1E,CAAC;IACD,8BAAS,GAAT;QACI,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAA;QACvE,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAA;QACrE,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAA;IAC3E,CAAC;IACD,kCAAa,GAAb;QAAA,iBAUC;QATG,IAAI,OAAO,GAAG,EAAE,CAAA;QAChB,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,UAAC,CAAC,EAAE,CAAC;YAC3B,IAAI,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,SAAS,CAAC,GAAG,CAAC;gBAChC,OAAO,IAAI,CAAC,CAAC,CAAC,SAAS,GAAG,CAAC,CAAC,IAAI,KAAI,CAAC,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAA;QACtF,CAAC,CAAC,CAAA;QACF,gDAAgD;QAChD,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;QAEjE,IAAI,CAAC,cAAc,EAAE,CAAC;IAC1B,CAAC;IACD,qCAAgB,GAAhB;QACI,kBAAQ,CAAC,OAAO,CAAC,kBAAQ,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAA;QAE9C,IAAI,CAAC,OAAO,CAAC,YAAY,EAAE,CAAA;QAC3B,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC;QACxB,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE,IAAI,EAAE,oBAAS,CAAC,QAAQ,EAAE,MAAM,EAAE,2BAAgB,CAAC,IAAI,EAAE,CAAC,CAAA;IACvF,CAAC;IACD,4BAAO,GAAP;QACI,kBAAQ,CAAC,OAAO,CAAC,kBAAQ,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAA;QAE9C,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,EAAE,CAAA;IAClC,CAAC;IACD,2BAAM,GAAN;QACI,kBAAQ,CAAC,OAAO,CAAC,kBAAQ,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAA;QAE9C,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,EAAE,CAAA;QAC5B,IAAI,CAAC,OAAO,CAAC,YAAY,EAAE,CAAA;QAC3B,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC;IAC5B,CAAC;IACD,4BAAO,GAAP;QACI,kBAAQ,CAAC,OAAO,CAAC,kBAAQ,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAA;QAC9C,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,EAAE,CAAA;QAC9B,IAAI,CAAC,OAAO,CAAC,YAAY,EAAE,CAAA;QAC3B,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC;IAC5B,CAAC;IACD,iCAAY,GAAZ,UAAa,KAAc;QACvB,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,KAAK,CAAA;QAC5B,8BAA8B;IAClC,CAAC;IACD,iCAAY,GAAZ,UAAa,MAAe;QACxB,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,YAAY,GAAG,MAAM,CAAA;QAC3D,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,YAAY,GAAG,MAAM,CAAA;QAC3D,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,YAAY,GAAG,MAAM,CAAA;IAC9D,CAAC;IACD,mCAAc,GAAd;QAAA,iBAUC;QATG,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,IAAI,CAAC;QAC5B,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,IAAI,CAAC;QAC5B,IAAI,CAAC,OAAO,GAAG;YACX,OAAO,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAA;YAC/B,QAAQ,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAA;QAC9B,CAAC,CAAA;QACD,IAAI,CAAC,OAAO,GAAG;YACX,MAAM,CAAC,QAAQ,CAAC,IAAI,GAAG,KAAI,CAAC,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,oCAAmB,CAAC,+BAAc,CAAC,UAAU,CAAC,CAAC,CAAC;QACrG,CAAC,CAAA;IACL,CAAC;IA9EiB;QAAjB,QAAQ,CAAC,MAAM,CAAC;sDAAkC;IAChC;QAAlB,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;gDAA0B;IACzB;QAAlB,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;+CAAyB;IACxB;QAAlB,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;gDAA0B;IACxB;QAAnB,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;iDAA4B;IAC3B;QAAnB,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;+CAA0B;IACzB;QAAnB,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;iDAA4B;IAC3B;QAAnB,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;gDAA2B;IAwElD,iBAAC;CAlFD,AAkFC,CAlF+B,eAAK,GAkFpC;AAlFY,gCAAU;AAmFvB,IAAM,eAAe,GAAG,UAAC,KAAgB,IAAK,OAAA,CAAC;IAC3C,KAAK,EAAE,KAAK,CAAC,KAAK;IAClB,SAAS,EAAE,KAAK,CAAC,SAAS;CAC7B,CAAC,EAH4C,CAG5C,CAAA;AACF,IAAM,mBAAmB,GAAG,UAAC,QAAqB,IAAK,OAAA,CAAC;IACpD,QAAQ,EAAE,cAAM,OAAA,QAAQ,CAAC,mBAAQ,EAAE,CAAC,EAApB,CAAoB;IACpC,SAAS,EAAE,UAAC,CAAC,IAAK,OAAA,QAAQ,CAAC,oBAAS,CAAC,CAAC,CAAC,CAAC,EAAtB,CAAsB;IACxC,YAAY,EAAE,cAAM,OAAA,QAAQ,CAAC,yBAAY,EAAE,CAAC,EAAxB,CAAwB;CAC/C,CAAC,EAJqD,CAIrD,CAAA;AACF,kBAAe,iBAAO,CAAC,eAAe,EAAE,mBAAmB,CAAC,CAAC,UAAU,CAAC,CAAA","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\nimport * as R from 'ramda'\nimport SoundMgr from \"../common/SoundMgr\";\nimport { ErrorHandleType } from \"../src/app/APIDefine\";\nimport connect from \"../src/app/connect\";\nimport { AppDispatch, RootState } from \"../src/app/store\";\nimport wsgw, { ErrorCode } from \"../src/app/wsgw\";\nimport { EAppPages, PAGE_SHOW_EFFECT, popPopup, popToPage, pushPage } from \"../src/features/SliceApp\";\nimport { DeeplinkTypesToName, EDeeplinkTypes } from '../src/features/SliceDeeplinks';\nimport { refreshError } from \"../src/features/SliceError\";\nimport Helper from \"../utils/Helper\";\nimport Popup from './Popup';\n\nconst { ccclass, property } = cc._decorator;\n\nexport const errorCodeToMessage = {\n    [ErrorCode.CLIENT_EXCEPTION]: 'Oops có trục trặc xảy ra. \\nVui lòng thử lại sau.',\n    [ErrorCode.CONECTION_TIMEOUT]: 'Không có phản hồi. \\nVui lòng thử lại sau.',\n    [ErrorCode.NOT_AUTHENTICATED]: 'Oops có trục trặc xảy ra. \\nVui lòng thử lại sau.',\n    [ErrorCode.OTHER_CASES]: 'Oops có trục trặc xảy ra. \\nVui lòng thử lại sau.',\n    [ErrorCode.SERVER_EXCEPTION]: 'Oops có trục trặc xảy ra. \\nVui lòng thử lại sau.',\n    [ErrorCode.TIMEOUT_TXT]: 'Không có phản hồi. \\nVui lòng thử lại sau.',\n}\nexport class PopupError extends Popup {\n    props: RootState\n    actions: any;\n    @property(String) public descriptionTxt = 'Lỗi %s';\n    @property(cc.Node) btnRetry: cc.Node = null;\n    @property(cc.Node) btnExit: cc.Node = null;\n    @property(cc.Node) btnClose: cc.Node = null;\n    @property(cc.Label) errorCode: cc.Label = null;\n    @property(cc.Label) message: cc.Label = null;\n    @property(cc.Label) retryName: cc.Label = null;\n    @property(cc.Label) exitName: cc.Label = null;\n    private retryCB: any;\n    private exitCB: any;\n    private closeCB: any;\n    // LIFE-CYCLE CALLBACKS:\n    onEnable() {\n        this.onStateChange();\n        this.btnRetry.on(cc.Node.EventType.TOUCH_END, this.onRetry.bind(this))\n        this.btnExit.on(cc.Node.EventType.TOUCH_END, this.onExit.bind(this))\n        this.btnClose.on(cc.Node.EventType.TOUCH_END, this.onClose.bind(this))\n    }\n    onDisable() {\n        this.btnRetry.off(cc.Node.EventType.TOUCH_END, this.onRetry.bind(this))\n        this.btnExit.off(cc.Node.EventType.TOUCH_END, this.onExit.bind(this))\n        this.btnClose.off(cc.Node.EventType.TOUCH_END, this.onClose.bind(this))\n    }\n    onStateChange() {\n        let errCode = \"\"\n        this.props.error.list.map((e, i) => {\n            if (errCode.indexOf(e.errorCode) < 0)\n                errCode += (e.errorCode + (i == this.props.error.list.length - 1 ? \".\" : \"/\"))\n        })\n        // this.errorCode.string = \"Mã Lỗi : \" + errCode\n        this.message.string = this.descriptionTxt.replace('%s', errCode);\n\n        this.createCallback();\n    }\n    onRedirectToHome() {\n        SoundMgr.playSfx(SoundMgr.Instance.SFX_BUTTON)\n\n        this.actions.refreshError()\n        this.actions.popPopup();\n        this.actions.popToPage({ page: EAppPages.PageHome, effect: PAGE_SHOW_EFFECT.LEFT })\n    }\n    onRetry() {\n        SoundMgr.playSfx(SoundMgr.Instance.SFX_BUTTON)\n\n        this.retryCB && this.retryCB()\n    }\n    onExit() {\n        SoundMgr.playSfx(SoundMgr.Instance.SFX_BUTTON)\n\n        this.exitCB && this.exitCB()\n        this.actions.refreshError()\n        this.actions.popPopup();\n    }\n    onClose() {\n        SoundMgr.playSfx(SoundMgr.Instance.SFX_BUTTON)\n        this.closeCB && this.closeCB()\n        this.actions.refreshError()\n        this.actions.popPopup();\n    }\n    activeButton(value: boolean) {\n        this.btnRetry.active = value\n        // this.btnExit.active = value\n    }\n    enableButton(enable: boolean) {\n        this.btnRetry.getComponent(cc.Button).interactable = enable\n        this.btnClose.getComponent(cc.Button).interactable = enable\n        this.btnExit.getComponent(cc.Button).interactable = enable\n    }\n    createCallback() {\n        this.btnRetry.active = true;\n        this.btnClose.active = true;\n        this.retryCB = () => {\n            console.log('askljfghaslkghas')\n            document.location.reload()\n        }\n        this.closeCB = () => {\n            window.location.href = this.props.deeplinks.data[DeeplinkTypesToName[EDeeplinkTypes.CLOSE_GAME]];\n        }\n    }\n}\nconst mapStateToProps = (state: RootState) => ({\n    error: state.error,\n    deeplinks: state.deeplinks,\n})\nconst mapDispatchToAction = (dispatch: AppDispatch) => ({\n    popPopup: () => dispatch(popPopup()),\n    popToPage: (e) => dispatch(popToPage(e)),\n    refreshError: () => dispatch(refreshError())\n})\nexport default connect(mapStateToProps, mapDispatchToAction)(PopupError)"]}